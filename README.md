# Нэхэмжлэхийн Төлбөрийн Дэлгэрэнгүй Мэдээлэл

## Тайлбар

Энэхүү модуль нь Odoo ERP систем дээр нэхэмжлэхийн төлбөрийн түүхийг харуулах боломжийг нэмсэн. Модуль нь дараах үндсэн функцуудыг агуулна:

- Нэхэмжлэхийн жагсаалт дээр "Төлөгдсөн дүн" баганыг нэмсэн
- Нэхэмжлэх бүрийн төгсгөлд "Дэлгэрэнгүй" товч нэмсэн
- Popup цонхоор төлбөрийн түүхийг дэлгэрэнгүй харуулах
- PDF тайлан дээр төлбөрийн мэдээллийг нэмсэн
- Зөвхөн эрх бүхий хэрэглэгчдэд л дэлгэрэнгүй мэдээлэл харуулах

## Шаардлагатай Хувилбар

- Odoo 16.0
- Python 3.8 эсвэл түүнээс дээш
- Үндсэн `account` модуль суулгагдсан байх

## Суулгах Заавар

### 1. Модулийг Татах

Модулийг Odoo-ийн custom addons хавтас руу хуулна:

```bash
cp -r invoice_payment_details /path/to/odoo/custom_addons/
```

### 2. Odoo Тохиргооны Файлд Нэмэх

`odoo.conf` файл дотор `addons_path`-д custom addons хавтсыг нэмнэ:

```ini
[options]
addons_path = /path/to/odoo/addons,/path/to/odoo/custom_addons
```

### 3. Odoo Серверийг Дахин Эхлүүлэх

```bash
./odoo-bin -c odoo.conf --stop-after-init
./odoo-bin -c odoo.conf
```

### 4. Модулийг Идэвхжүүлэх

1. Odoo системд нэвтэрч, Apps цэс рүү орно
2. Filters дээр "Apps" гэснийг арилгаж, бүх модулиудыг харуулна
3. Хайлтын талбарт "Invoice Payment Details" гэж хайна
4. "Install" товч дээр дарж модулийг идэвхжүүлнэ

## Тохиргоо

### Хэрэглэгчийн Эрх Тохируулах

Модуль нь 2 төрлийн эрхийн бүлэг агуулдаг:

#### 1. Ажилтан (Employee)

- Үндсэн хэрэглэгчийн эрх
- Зөвхөн төлөгдсөн дүнг харах боломжтой

#### 2. Ерөнхий Нягтлан Бодогч (Accountant)

- Бүрэн эрх
- Төлбөрийн түүхийн дэлгэрэнгүй мэдээлэл харах боломжтой

### Эрх Олгох

1. Settings → Users & Companies → Users
2. Хэрэглэгч сонгох
3. Access Rights табруу орох
4. "Accounting" секц дотор "Ерөнхий нягтлан бодогч" эрхийг идэвхжүүлэх

## Хэрэглэх Заавар

### Нэхэмжлэхийн Жагсаалт Дээр

1. **Accounting → Customers → Invoices** цэс рүү орно
2. Жагсаалт дээр "Төлөгдсөн дүн" багана харагдана
3. Нэхэмжлэх бүрийн хажууд "Дэлгэрэнгүй" товч байна

### Төлбөрийн Түүх Харах

1. Нэхэмжлэхийн жагсаалтаас хүссэн нэхэмжлэхээ олно
2. "Дэлгэрэнгүй" товч дээр дарна
3. Popup цонх нээгдэж дараах мэдээллүүд харагдана:
   - Төлбөр төлөгдсөн огноо
   - Төлсөн дүн
   - Журналын нэр
   - Тайлбар

### PDF Тайлан Хэвлэх

1. Нэхэмжлэх нээх
2. "Print → Invoice" сонгох
3. PDF тайлан дээр төлбөрийн түүх автоматаар харагдана

## Техникийн Мэдээлэл

### Модулийн Бүтэц

```
invoice_payment_details/
├── __init__.py
├── __manifest__.py
├── models/
│   ├── __init__.py
│   └── account_move.py          # Нэхэмжлэхийн модель өргөтгөл
├── wizard/
│   ├── __init__.py
│   ├── payment_history_wizard.py
│   └── payment_history_wizard_views.xml
├── views/
│   └── account_move_views.xml   # Нэхэмжлэхийн жагсаалтын харагдац
├── reports/
│   └── invoice_report_template.xml  # PDF тайлангийн загвар
├── security/
│   ├── security.xml             # Эрхийн бүлгүүд
│   └── ir.model.access.csv      # Хандалтын эрх
└── README.md
```

### Үндсэн Функцууд

#### 1. `amount_paid` Талбар

`account.move` модель дээр тооцоолсон талбар:

```python
amount_paid = amount_total - amount_residual
```

#### 2. `action_view_payment_history()` Арга

Popup цонх нээж төлбөрийн түүхийг харуулна.

#### 3. `_get_reconciled_payments()` Ашиглалт

Odoo-ийн стандарт аргыг ашиглан нэхэмжлэхтэй холбоотой төлөлтүүдийг олдог.

## Алдааны Шалтгаанууд

### Дэлгэрэнгүй товч харагдахгүй байна

**Шалтгаан**: Хэрэглэгчид зохих эрх олгогдоогүй байна.

**Шийдэл**:

1. Settings → Users & Companies → Users
2. Хэрэглэгч сонгох
3. "Ерөнхий нягтлан бодогч" эрх олгох

### Төлбөрийн түүх хоосон харагдана

**Шалтгаан**: Нэхэмжлэхэнд төлөлт хийгдээгүй эсвэл reconcile хийгдээгүй байна.

**Шийдэл**:

1. Төлөлт үүсгэсэн эсэхийг шалгах
2. Төлөлт ба нэхэмжлэх reconcile хийгдсэн эсэхийг баталгаажуулах

### PDF тайлан дээр төлбөрийн мэдээлэл харагдахгүй

**Шалтгаан**: Модуль зөв суулгагдаагүй эсвэл template алдаатай байна.

**Шийдэл**:

1. Модулийг дахин upgrade хийх
2. Серверийн логийг шалгах

```bash
./odoo-bin -c odoo.conf -u invoice_payment_details
```
